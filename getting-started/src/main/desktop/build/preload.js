"use strict";var electron=require("electron");function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t,s){return e(s={path:t,exports:{},require:function(e,t){return commonjsRequire(e,null==t?s.path:t)}},s.exports),s.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var adblocker=createCommonjsModule((function(e,t){function s(e){const t=[];for(let s=0;s<e.length;s+=1){const n=e[s];if("attributes"===n.type)t.push(n.target);else if("childList"===n.type){const e=n.addedNodes;for(let s=0;s<e.length;s+=1){const n=e[s];if(t.push(n),void 0!==n.querySelectorAll){const e=n.querySelectorAll("[id],[class],[href]");for(let s=0;s<e.length;s+=1)t.push(e[s])}}}}return t}function n(e){const t=new Set(["br","head","link","meta","script","style"]),s=new Set,n=new Set,r=new Set;for(let o=0;o<e.length;o+=1){const i=e[o];if(1!==i.nodeType)continue;if(void 0!==i.localName&&t.has(i.localName))continue;const c=i.id;c&&r.add(c);const l=i.classList;if(l)for(let e=0;e<l.length;e+=1)s.add(l[e]);const a=i.href;"string"==typeof a&&n.add(a)}return{classes:Array.from(s),hrefs:Array.from(n),ids:Array.from(r)}}
/*!
 * Copyright (c) 2017-2019 Cliqz GmbH. All rights reserved.
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
Object.defineProperty(t,"__esModule",{value:!0}),t.injectScript=t.injectCSSRule=t.autoRemoveScript=t.DOMMonitor=t.extractFeaturesFromDOM=t.getDOMElementsFromMutations=void 0,t.getDOMElementsFromMutations=s,t.extractFeaturesFromDOM=n;function r(e){return`try{${e}}catch(c){}!function(){var c=document.currentScript,e=c&&c.parentNode;e&&e.removeChild(c)}();`}t.DOMMonitor=class{constructor(e){this.cb=e,this.knownIds=new Set,this.knownHrefs=new Set,this.knownClasses=new Set,this.observer=null}queryAll(e){this.handleNewNodes(Array.from(e.document.querySelectorAll("[id],[class],[href]")))}start(e){null===this.observer&&void 0!==e.MutationObserver&&(this.observer=new e.MutationObserver(e=>{this.handleNewNodes(s(e))}),this.observer.observe(e.document.documentElement,{attributeFilter:["class","id","href"],attributes:!0,childList:!0,subtree:!0}))}stop(){null!==this.observer&&(this.observer.disconnect(),this.observer=null)}handleNewFeatures({hrefs:e,ids:t,classes:s}){const n=[],r=[],o=[];for(let e=0;e<t.length;e+=1){const s=t[e];!1===this.knownIds.has(s)&&(n.push(s),this.knownIds.add(s))}for(let e=0;e<s.length;e+=1){const t=s[e];!1===this.knownClasses.has(t)&&(r.push(t),this.knownClasses.add(t))}for(let t=0;t<e.length;t+=1){const s=e[t];!1===this.knownHrefs.has(s)&&(o.push(s),this.knownHrefs.add(s))}return(0!==n.length||0!==r.length||0!==o.length)&&(this.cb({classes:r,hrefs:o,ids:n}),!0)}handleNewNodes(e){return this.handleNewFeatures(n(e))}},t.autoRemoveScript=r,t.injectCSSRule=function(e,t){const s=t.head||t.getElementsByTagName("head")[0]||t.documentElement;if(null!==s){const n=t.createElement("style");n.type="text/css",n.id="cliqz-adblokcer-css-rules",n.appendChild(t.createTextNode(e)),s.appendChild(n)}},t.injectScript=function(e,t){const s=t.createElement("script");s.type="text/javascript",s.id="cliqz-adblocker-script",s.async=!1,s.appendChild(t.createTextNode(r(e)));const n=t.head||t.documentElement;null!==n&&n.appendChild(s)}})),adblocker$1=unwrapExports(adblocker);
/*!
 * Copyright (c) 2017-2019 Cliqz GmbH. All rights reserved.
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
function getCosmeticsFilters(e){setTimeout(()=>{electron.ipcRenderer.send("get-cosmetic-filters",window.location.href,e)},1)}window===window.top&&!1===window.location.href.startsWith("devtools://")&&(()=>{const e=electron.ipcRenderer.sendSync("is-mutation-observer-enabled");let t=!0,s=null;const n=()=>{null!==s&&(s.stop(),s=null)};electron.ipcRenderer.on("get-cosmetic-filters-response",(e,{active:s,scripts:r})=>{if(!1===s)return t=!1,void n();t=!0;for(let e=0;e<r.length;e+=1)setTimeout(()=>electron.webFrame.executeJavaScript(r[e]),1)}),getCosmeticsFilters({lifecycle:"start",ids:[],classes:[],hrefs:[]}),window.addEventListener("DOMContentLoaded",()=>{s=new adblocker$1.DOMMonitor(({classes:e,ids:t,hrefs:s})=>{getCosmeticsFilters({classes:e,hrefs:s,ids:t,lifecycle:"dom-update"})}),s.queryAll(window),t&&e&&s.start(window)},{once:!0,passive:!0}),window.addEventListener("unload",n,{once:!0,passive:!0})})();